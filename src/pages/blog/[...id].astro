---
import Layout from "@/layouts/Layout.astro";
import { FaArrowLeft, FaCalendarAlt, FaUserEdit } from "react-icons/fa";
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import { getCollection } from "astro:content";
import { fade } from "astro:transitions";

export async function getStaticPaths() {
  const blogs: CollectionEntry<"blog">[] = await getCollection("blog");
  return blogs.map((entrada) => ({
    params: { id: entrada.id },
    props: { entrada },
  }));
}

const { entrada } = Astro.props;
const { data } = entrada;
---

<Layout titulo={`Smart House - ${data.titulo}`} descripcion={data.descripcion}>
  <article
    class="min-h-screen bg-base-100"
    transition:animate={fade({ duration: "0.4s" })}
  >
    <header class="relative w-full h-[60vh] md:h-[70vh] overflow-hidden">
      <Image
        src={data.imagen}
        alt={data.titulo}
        width={1600}
        height={900}
        class="absolute inset-0 w-full h-full object-cover z-0"
        loading="eager"
      />
      <div
        class="absolute inset-0 bg-linear-to-t from-base-100 via-transparent to-black/30 z-10"
      >
      </div>

      <div
        class="absolute inset-0 z-20 flex flex-col justify-end items-center pb-12 px-4 text-center"
      >
        <div
          class="badge badge-warning mb-4 uppercase tracking-widest font-bold px-4 py-3"
        >
          Apartamento
        </div>
        <h1
          class="text-4xl md:text-7xl font-black text-white drop-shadow-lg max-w-5xl"
        >
          {data.titulo}
        </h1>
      </div>
    </header>

    <main class="container mx-auto max-w-4xl px-6 -mt-10 relative z-30">
      <div
        class="bg-base-200/80 backdrop-blur-md rounded-3xl p-6 md:p-8 shadow-xl border border-base-300"
      >
        <div
          class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center border-b border-base-300 pb-6 mb-6"
        >
          <div class="flex items-center gap-3 justify-center md:justify-start">
            <div class="avatar placeholder">
              <div class="bg-neutral text-neutral-content rounded-full w-10">
                <FaUserEdit />
              </div>
            </div>
            <div>
              <p class="text-xs opacity-60 uppercase font-bold">Autor</p>
              <p class="font-semibold">{data.autor}</p>
            </div>
          </div>

          <div class="flex items-center gap-3 justify-center">
            <FaCalendarAlt className="text-warning text-xl" />
            <div>
              <p class="text-xs opacity-60 uppercase font-bold">Publicado</p>
              <p class="font-semibold">{data.fecha}</p>
            </div>
          </div>

          <div class="flex flex-wrap gap-2 justify-center md:justify-end">
            {
              data.tags.map((tag) => (
                <span class="badge badge-warning badge-md font-thin">
                  {tag}
                </span>
              ))
            }
          </div>
        </div>

        <p
          class="text-xl italic text-center text-base-content/70 leading-relaxed font-light mb-8"
        >
          "{data.descripcion}"
        </p>

        <div
          class="prose prose-lg md:prose-xl max-w-none
                 prose-headings:font-bold prose-headings:text-primary
                 prose-p:leading-relaxed prose-p:text-justify
                 prose-img:rounded-2xl prose-img:shadow-lg"
          data-aos="fade-up"
          set:html={entrada.rendered?.html}
        />

        <div class="mt-16 flex justify-center">
          <a
            href="/#blog"
            class="btn btn-warning btn-wide md:btn-lg rounded-full group transition-all"
          >
            <FaArrowLeft
              className="group-hover:-translate-x-2 transition-transform"
            />
            Volver al Blog
          </a>
        </div>
      </div>
    </main>

    <div class="h-20"></div>
  </article>
</Layout>

<style is:global>
  /* Personalizaci√≥n extra para el HTML renderizado si no usas @tailwindcss/typography */
  .prose p {
    margin-bottom: 1.5rem;
  }
</style>
